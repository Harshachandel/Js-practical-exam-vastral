<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Invoice Generator</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <style>
        body { background: #f4f6f8; }
        .card { margin-top: 20px; }
    </style>
</head>
<body>

<div class="container">

    <h2 class="text-center mt-4">Invoice Generator System</h2>

   
    <div class="card p-3">
        <h5>Add Item</h5>

        <input type="text" id="itemName" class="" placeholder="Item Name">
        <input type="number" id="qty" class="" placeholder="Quantity">
        <input type="number" id="price" class="" placeholder="Price per Unit">
        <input type="number" id="discount" class="" placeholder="Discount (%)">

        <button class="btn btn-success" onclick="addItem()">Add Item</button>
    </div>

    <div class="card p-3">
        <h5>Invoice</h5>

        <table class="table table-bordered mt-2">
            <thead>
                <tr>
                    <th>Item</th>
                    <th>Qty</th>
                    <th>Price</th>
                    <th>Discount</th>
                    <th>Total</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody id="invoiceList"></tbody>
        </table>
    </div>

    <div class="card p-3">
        <h6>Subtotal:  <span id="subTotal">0</span></h6>
        <h6>Total Discount:  <span id="totalDiscount">0</span></h6>
        <h6>GST (18%):  <span id="tax">0</span></h6>
        <h4>Total Amount Payable :  <span id="grandTotal">0</span></h4>

        <button class="btn btn-info" onclick="resetInvoice()">Reset Invoice</button>
    </div>

</div>

<script>
   
    let items = JSON.parse(localStorage.getItem("invoiceItems")) || [];
    let gstRate = 18;

    
    showInvoice();


  
    function addItem() {

        let name = document.getElementById("itemName").value;
        let qty = document.getElementById("qty").value;
        let price = document.getElementById("price").value;
        let discount = document.getElementById("discount").value || 0;

        // if (name === "" || qty === "" || price === "") {
        //     alert("Please fill all required fields");
        //     return;
        // }

        // if (qty <= 0 || price <= 0 || discount < 0) {
        //     alert("Invalid input values");
        //     return;
        // }

        let total = qty * price;
        let discountAmount = (total * discount) / 100;
        let finalAmount = total - discountAmount;

        let item = {
            name: name,
            qty: qty,
            price: price,
            discount: discount,
            finalAmount: finalAmount,
            discountAmount: discountAmount
        };

        items.push(item);
        
        console.log(item)


        localStorage.setItem("invoiceItems", JSON.stringify(items));

        // reset()
        
        document.getElementById("itemName").value = "";
        document.getElementById("qty").value = "";
        document.getElementById("price").value = "";
        document.getElementById("discount").value = "";

        showInvoice();

    }


    function showInvoice() {
        let list = "";
        let subTotal = 0;
        let totalDiscount = 0;

        for (let i = 0; i < items.length; i++) {
            list += `
                <tr>
                    <td>${items[i].name}</td>
                    <td>${items[i].qty}</td>
                    <td> ${items[i].price}</td>
                    <td>${items[i].discount}%</td>
                    <td> ${items[i].finalAmount}</td>
                    <td>
                        <button class="btn text-white bg-danger" onclick=" deleteItem(${i})">
                            Delete
                        </button>
                    </td>
                </tr>
            `;

            subTotal += items[i].finalAmount;
            totalDiscount += items[i].discountAmount;
        }

        let tax = (subTotal * gstRate) / 100;
        let grandTotal = subTotal + tax;

        document.getElementById("invoiceList").innerHTML = list;
        document.getElementById("subTotal").innerText = subTotal;
        document.getElementById("totalDiscount").innerText = totalDiscount;
        document.getElementById("tax").innerText = tax;
        document.getElementById("grandTotal").innerText = grandTotal;
    }

    function deleteItem(index) {
        items.splice(index,1);
        localStorage.setItem("invoiceItems", JSON.stringify(items));
        showInvoice();
    }


    function resetInvoice() {
        items = [];
        localStorage.removeItem("invoiceItems");
        showInvoice();

    }


</script>

</body>
</html>

